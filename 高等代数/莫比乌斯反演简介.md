### **莫比乌斯反演简介**

莫比乌斯反演（Möbius Inversion）是数论中的一项重要工具，主要用于处理数论函数之间的关系，尤其是在研究**整除关系**或**积性函数**时。它的核心思想是利用莫比乌斯函数 \(\mu(n)\) 来实现某种形式的“逆变换”。

---

### **莫比乌斯反演公式**

假设有两个函数 \( f(n) \) 和 \( g(n) \)，它们通过以下关系相互定义：

$$
\
g(n) = \sum_{d \mid n} f(d),
\
$$

$$
其中，\ \sum_{d \mid n} \ 表示对 \ n \ 的所有正因子 \ d \ 求和。
$$

$$
那么，\ f(n) \ 可以通过 莫比乌斯反演 表示为：

\
f(n) = \sum_{d \mid n} \mu(d) g\left(\frac{n}{d}\right),
\\

或者等价地写成：

\
f(n) = \sum_{d \mid n} \mu\left(\frac{n}{d}\right) g(d).
\
$$



---

### **莫比乌斯函数 \(\mu(n)\)**

莫比乌斯函数是莫比乌斯反演的核心。它的定义如下：

$$
\
\mu(n) =
\begin{cases}
1, & \text{如果 } n = 1, \\
0, & \text{如果 } n \text{ 含有平方因子（即存在素数 } p \text{ 使得 } p^2 \mid n\text{）}, \\
(-1)^k, & \text{如果 } n \text{ 是 } k \text{ 个不同素数的乘积}.
\end{cases}
\
$$
简单来说：
- $$
  若 \ n = 1 \ ，则 \ \mu(1) = 1\ ；
  $$

  
- $$
  若 \ n \ 含有平方因子（如 \ 12 = 2^2 \times 3 \ ），则 \ \mu(n) = 0\ ；
  $$

  
- $$
  若 \ n \ 是 \ k \ 个不同素数的乘积（如 \ 30 = 2 \times 3 \times 5 \ ），则 \ \mu(n) = (-1)^k\ 。
  $$

  

---

### **莫比乌斯反演的直观解释**

1. $$
   \ g(n) = \sum_{d \mid n} f(d) \ 表示 \ g(n) \ 是 \ f(d) \ 对 \ n \ 的所有正因子的累加。
   $$

   
2. 莫比乌斯反演的作用是“逆转”这一过程，即通过 \( g(n) \) 反推出 \( f(n) \)。

莫比乌斯函数的关键性质是它在整除关系中的“抵消效应”，这使得我们能够从累加值 \( g(n) \) 中提取原始值 \( f(n) \)。

---

### **莫比乌斯反演的应用**

莫比乌斯反演在数论中用途广泛，以下是几个常见的应用场景：

#### 1. **积性函数的研究**
$$
很多积性函数（如欧拉函数、约数和函数）可以通过莫比乌斯反演进行转换。\\例如，欧拉函数 \ \phi(n)\ 的定义为：
\
\phi(n) = n \prod_{p \mid n} \left(1 - \frac{1}{p}\right),
\
\\也可以通过莫比乌斯反演表示为：
\
\phi(n) = \sum_{d \mid n} \mu(d) \frac{n}{d}.
\
$$



#### 2. **约数函数的反演**
$$
设 \ \sigma(n) \ 表示 \ n \ 的所有正因子的和，即：
\
\sigma(n) = \sum_{d \mid n} d.
\\
通过莫比乌斯反演，可以得到：
\
n = \sum_{d \mid n} \mu(d) \sigma\left(\frac{n}{d}\right).
\
$$



#### 3. **容斥原理的推广**
莫比乌斯反演可以看作是容斥原理在数论中的一种形式。例如，用于求解某些整除问题或计数问题。

#### 4. **狄利克雷卷积的反演**
$$
莫比乌斯反演也可以看作是对狄利克雷卷积的反演。如果 \ g(n) = (f * 1)(n) \ ，\\其中 \ (f * 1)(n) = \sum_{d \mid n} f(d) \ ，那么 \ f(n) \ 可表示为：
\
f(n) = (g * \mu)(n).
\
$$



---

### **莫比乌斯反演的证明**
莫比乌斯反演公式的证明基于莫比乌斯函数的一个重要性质：

$$
\
\sum_{d \mid n} \mu(d) =
\begin{cases}
1, & \text{当 } n = 1, \\
0, & \text{当 } n > 1.
\end{cases}
\
$$
证明步骤如下：
1. $$
   假设 \ g(n) = \sum_{d \mid n} f(d) \ ，我们需要反推出 \ f(n) \ 。
   $$

   
2. $$
   将 \ g(n) \ 的定义代入 \ f(n) = \sum_{d \mid n} \mu(d) g\left(\frac{n}{d}\right) \ 中。
   $$

   
3. 利用莫比乌斯函数的性质和整除关系的对称性，验证公式成立。

---

### **例题解析**

#### 例 1：
$$
求 \ \phi(n) \ 的莫比乌斯反演公式
$$

$$
已知 \ n \ 的正整数个数为 \ g(n) = n \ ，即：
\
g(n) = \sum_{d \mid n} f(d),
\
其中 \ f(d) = \phi(d) \ 。\\利用莫比乌斯反演公式，有：
\
\phi(n) = \sum_{d \mid n} \mu(d) \cdot \frac{n}{d}.
\
$$



#### 例 2：计数满足整除关系的整数数目
$$
设 \ f(n) \ 表示所有满足 \ n \mid k \ 的正整数 \ k \ 的个数，显然 \ f(n) = \infty \ 。\\若我们限制 \ k \leq x \ ，则：
\
g(n) = \text{所有满足 } n \mid k \text{ 且 } k \leq x \text{ 的 } k \text{ 的个数}.
\
\\通过莫比乌斯反演可以将 \ g(n) \ 反推出 \ f(n) \ 。

$$

莫比乌斯反演在数论中是非常强大的工具，尤其是在研究整除关系或积性函数时，是不可或缺的基本技术。